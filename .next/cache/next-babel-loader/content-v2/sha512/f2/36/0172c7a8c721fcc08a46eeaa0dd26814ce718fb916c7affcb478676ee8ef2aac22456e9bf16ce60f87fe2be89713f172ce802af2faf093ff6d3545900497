{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/juanma/projects/membrane-front/src/legacy/views/SignUp/steps/Security.js\",\n    _s = $RefreshSig$();\n\nimport { memo, useState } from 'react';\nimport classnames from 'classnames'; //styles\n\nimport * as styles from '../styles.module.scss'; //components\n\nimport Form from '../../../components/Form';\nimport DigitCode from '../../../components/DigitCode'; //hooks\n\nimport useUser from '../../../hooks/useUser';\nexport default _c2 = /*#__PURE__*/memo(_c = _s(function Security(props) {\n  var _props$userInfo$phone,\n      _this = this;\n\n  _s();\n\n  //bind styles\n  classnames.bind(styles); //hook user\n\n  var _useUser = useUser(),\n      twoFactorSignUp = _useUser.twoFactorSignUp,\n      requestNewSecurityCode = _useUser.requestNewSecurityCode,\n      clearToken = _useUser.clearToken; //states\n\n\n  var _useState = useState(''),\n      customError = _useState[0],\n      setCustomError = _useState[1];\n\n  var _useState2 = useState(''),\n      codeValue = _useState2[0],\n      setCodeValue = _useState2[1];\n\n  var _useState3 = useState(false),\n      codeComplete = _useState3[0],\n      setCodeComplete = _useState3[1];\n\n  var onSignUp = function onSignUp() {\n    var payload = {\n      code: codeValue\n    };\n    twoFactorSignUp(payload).then(function () {\n      props.onComplete();\n    })[\"catch\"](function (error) {\n      return setCustomError({\n        field: 'digit',\n        type: 'custom',\n        message: error === null || error === void 0 ? void 0 : error.message\n      });\n    });\n  };\n\n  var onCancel = function onCancel() {\n    clearToken();\n    props.history.push('/sign-in');\n  };\n\n  var onRequestNewCode = function onRequestNewCode() {\n    setCustomError('');\n    setCodeComplete(false);\n    requestNewSecurityCode()[\"catch\"](function (error) {\n      return setCustomError({\n        field: 'digit',\n        type: 'custom',\n        message: error === null || error === void 0 ? void 0 : error.message\n      });\n    });\n  };\n\n  var onDigitCodeChange = function onDigitCodeChange(digitInput, value) {\n    setCodeValue(value);\n    setCodeComplete(!digitInput.filter(function (digit) {\n      return !digit.value;\n    }).length);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n      children: [\"Please confirm that your phone works. We just sent you a text message with a verification code to ******\", (_props$userInfo$phone = props.userInfo.phoneNumber) === null || _props$userInfo$phone === void 0 ? void 0 : _props$userInfo$phone.slice(-2), \".\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      children: \"*Required fields\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.signUpForm2FA,\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        customError: customError,\n        items: [{\n          label: 'Enter your 6-digit code',\n          name: 'digit',\n          type: 'custom',\n          customComponent: function customComponent() {\n            return /*#__PURE__*/_jsxDEV(DigitCode, {\n              digits: 6,\n              onDigitCodeChange: onDigitCodeChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 19\n            }, _this);\n          }\n        }],\n        actions: [{\n          type: 'primary',\n          label: 'Sign In',\n          disabled: !codeComplete,\n          onClick: onSignUp\n        }, {\n          type: 'secondary',\n          label: 'Cancel',\n          onClick: onCancel\n        }, {\n          type: 'tertiary',\n          label: 'Send new code',\n          onClick: onRequestNewCode\n        }]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}, \"24gCoW/OG+xBP1tiUtYYmNJ7/og=\", false, function () {\n  return [useUser];\n}));\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"%default%$memo\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/home/juanma/projects/membrane-front/src/legacy/views/SignUp/steps/Security.js"],"names":["memo","useState","classnames","styles","Form","DigitCode","useUser","Security","props","bind","twoFactorSignUp","requestNewSecurityCode","clearToken","customError","setCustomError","codeValue","setCodeValue","codeComplete","setCodeComplete","onSignUp","payload","code","then","onComplete","error","field","type","message","onCancel","history","push","onRequestNewCode","onDigitCodeChange","digitInput","value","filter","digit","length","userInfo","phoneNumber","slice","signUpForm2FA","label","name","customComponent","disabled","onClick"],"mappings":"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","sourcesContent":["import { memo, useState } from 'react';\nimport classnames from 'classnames';\n\n//styles\nimport * as styles from '../styles.module.scss';\n\n//components\nimport Form from '../../../components/Form';\nimport DigitCode from '../../../components/DigitCode';\n\n//hooks\nimport useUser from '../../../hooks/useUser';\n\nexport default memo(function Security(props) {\n  //bind styles\n  classnames.bind(styles);\n\n  //hook user\n  const { twoFactorSignUp, requestNewSecurityCode, clearToken } = useUser();\n\n  //states\n  const [customError, setCustomError] = useState('');\n  const [codeValue, setCodeValue] = useState('');\n  const [codeComplete, setCodeComplete] = useState(false);\n\n  const onSignUp = () => {\n    const payload = { code: codeValue };\n\n    twoFactorSignUp(payload)\n      .then(() => {\n        props.onComplete();\n      })\n      .catch(error =>\n        setCustomError({\n          field: 'digit',\n          type: 'custom',\n          message: error?.message\n        })\n      );\n  };\n\n  const onCancel = () => {\n    clearToken();\n    props.history.push('/sign-in');\n  };\n\n  const onRequestNewCode = () => {\n    setCustomError('');\n    setCodeComplete(false);\n    requestNewSecurityCode().catch(error =>\n      setCustomError({\n        field: 'digit',\n        type: 'custom',\n        message: error?.message\n      })\n    );\n  };\n\n  const onDigitCodeChange = (digitInput, value) => {\n    setCodeValue(value);\n    setCodeComplete(!digitInput.filter(digit => !digit.value).length);\n  };\n\n  return (\n    <>\n      <label>\n        Please confirm that your phone works. We just sent you a text message\n        with a verification code to ******\n        {props.userInfo.phoneNumber?.slice(-2)}.\n      </label>\n      <span>*Required fields</span>\n      <div className={styles.signUpForm2FA}>\n        <Form\n          customError={customError}\n          items={[\n            {\n              label: 'Enter your 6-digit code',\n              name: 'digit',\n              type: 'custom',\n              customComponent: () => {\n                return (\n                  <DigitCode digits={6} onDigitCodeChange={onDigitCodeChange} />\n                );\n              }\n            }\n          ]}\n          actions={[\n            {\n              type: 'primary',\n              label: 'Sign In',\n              disabled: !codeComplete,\n              onClick: onSignUp\n            },\n            {\n              type: 'secondary',\n              label: 'Cancel',\n              onClick: onCancel\n            },\n            {\n              type: 'tertiary',\n              label: 'Send new code',\n              onClick: onRequestNewCode\n            }\n          ]}\n        />\n      </div>\n    </>\n  );\n});\n"]},"metadata":{},"sourceType":"module"}