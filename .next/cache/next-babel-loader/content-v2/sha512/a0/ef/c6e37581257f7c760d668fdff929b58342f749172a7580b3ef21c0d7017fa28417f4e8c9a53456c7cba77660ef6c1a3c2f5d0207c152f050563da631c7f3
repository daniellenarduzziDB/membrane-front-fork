{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/juanma/projects/membrane-front/src/legacy/views/SignUp/steps/Security.js\";\nimport { memo, useState } from 'react';\nimport classnames from 'classnames'; //styles\n\nimport * as styles from '../styles.module.scss'; //components\n\nimport Form from '../../../components/Form';\nimport DigitCode from '../../../components/DigitCode'; //hooks\n\nimport useUser from '../../../hooks/useUser';\nexport default /*#__PURE__*/memo(function Security(props) {\n  var _props$userInfo$phone;\n\n  //bind styles\n  classnames.bind(styles); //hook user\n\n  const {\n    twoFactorSignUp,\n    requestNewSecurityCode,\n    clearToken\n  } = useUser(); //states\n\n  const {\n    0: customError,\n    1: setCustomError\n  } = useState('');\n  const {\n    0: codeValue,\n    1: setCodeValue\n  } = useState('');\n  const {\n    0: codeComplete,\n    1: setCodeComplete\n  } = useState(false);\n\n  const onSignUp = () => {\n    const payload = {\n      code: codeValue\n    };\n    twoFactorSignUp(payload).then(() => {\n      props.onComplete();\n    }).catch(error => setCustomError({\n      field: 'digit',\n      type: 'custom',\n      message: error === null || error === void 0 ? void 0 : error.message\n    }));\n  };\n\n  const onCancel = () => {\n    clearToken();\n    props.history.push('/sign-in');\n  };\n\n  const onRequestNewCode = () => {\n    setCustomError('');\n    setCodeComplete(false);\n    requestNewSecurityCode().catch(error => setCustomError({\n      field: 'digit',\n      type: 'custom',\n      message: error === null || error === void 0 ? void 0 : error.message\n    }));\n  };\n\n  const onDigitCodeChange = (digitInput, value) => {\n    setCodeValue(value);\n    setCodeComplete(!digitInput.filter(digit => !digit.value).length);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n      children: [\"Please confirm that your phone works. We just sent you a text message with a verification code to ******\", (_props$userInfo$phone = props.userInfo.phoneNumber) === null || _props$userInfo$phone === void 0 ? void 0 : _props$userInfo$phone.slice(-2), \".\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      children: \"*Required fields\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.signUpForm2FA,\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        customError: customError,\n        items: [{\n          label: 'Enter your 6-digit code',\n          name: 'digit',\n          type: 'custom',\n          customComponent: () => {\n            return /*#__PURE__*/_jsxDEV(DigitCode, {\n              digits: 6,\n              onDigitCodeChange: onDigitCodeChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 19\n            }, this);\n          }\n        }],\n        actions: [{\n          type: 'primary',\n          label: 'Sign In',\n          disabled: !codeComplete,\n          onClick: onSignUp\n        }, {\n          type: 'secondary',\n          label: 'Cancel',\n          onClick: onCancel\n        }, {\n          type: 'tertiary',\n          label: 'Send new code',\n          onClick: onRequestNewCode\n        }]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n});","map":{"version":3,"sources":["/home/juanma/projects/membrane-front/src/legacy/views/SignUp/steps/Security.js"],"names":["memo","useState","classnames","styles","Form","DigitCode","useUser","Security","props","bind","twoFactorSignUp","requestNewSecurityCode","clearToken","customError","setCustomError","codeValue","setCodeValue","codeComplete","setCodeComplete","onSignUp","payload","code","then","onComplete","catch","error","field","type","message","onCancel","history","push","onRequestNewCode","onDigitCodeChange","digitInput","value","filter","digit","length","userInfo","phoneNumber","slice","signUpForm2FA","label","name","customComponent","disabled","onClick"],"mappings":"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","sourcesContent":["import { memo, useState } from 'react';\nimport classnames from 'classnames';\n\n//styles\nimport * as styles from '../styles.module.scss';\n\n//components\nimport Form from '../../../components/Form';\nimport DigitCode from '../../../components/DigitCode';\n\n//hooks\nimport useUser from '../../../hooks/useUser';\n\nexport default memo(function Security(props) {\n  //bind styles\n  classnames.bind(styles);\n\n  //hook user\n  const { twoFactorSignUp, requestNewSecurityCode, clearToken } = useUser();\n\n  //states\n  const [customError, setCustomError] = useState('');\n  const [codeValue, setCodeValue] = useState('');\n  const [codeComplete, setCodeComplete] = useState(false);\n\n  const onSignUp = () => {\n    const payload = { code: codeValue };\n\n    twoFactorSignUp(payload)\n      .then(() => {\n        props.onComplete();\n      })\n      .catch(error =>\n        setCustomError({\n          field: 'digit',\n          type: 'custom',\n          message: error?.message\n        })\n      );\n  };\n\n  const onCancel = () => {\n    clearToken();\n    props.history.push('/sign-in');\n  };\n\n  const onRequestNewCode = () => {\n    setCustomError('');\n    setCodeComplete(false);\n    requestNewSecurityCode().catch(error =>\n      setCustomError({\n        field: 'digit',\n        type: 'custom',\n        message: error?.message\n      })\n    );\n  };\n\n  const onDigitCodeChange = (digitInput, value) => {\n    setCodeValue(value);\n    setCodeComplete(!digitInput.filter(digit => !digit.value).length);\n  };\n\n  return (\n    <>\n      <label>\n        Please confirm that your phone works. We just sent you a text message\n        with a verification code to ******\n        {props.userInfo.phoneNumber?.slice(-2)}.\n      </label>\n      <span>*Required fields</span>\n      <div className={styles.signUpForm2FA}>\n        <Form\n          customError={customError}\n          items={[\n            {\n              label: 'Enter your 6-digit code',\n              name: 'digit',\n              type: 'custom',\n              customComponent: () => {\n                return (\n                  <DigitCode digits={6} onDigitCodeChange={onDigitCodeChange} />\n                );\n              }\n            }\n          ]}\n          actions={[\n            {\n              type: 'primary',\n              label: 'Sign In',\n              disabled: !codeComplete,\n              onClick: onSignUp\n            },\n            {\n              type: 'secondary',\n              label: 'Cancel',\n              onClick: onCancel\n            },\n            {\n              type: 'tertiary',\n              label: 'Send new code',\n              onClick: onRequestNewCode\n            }\n          ]}\n        />\n      </div>\n    </>\n  );\n});\n"]},"metadata":{},"sourceType":"module"}