{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useCallback, useContext } from 'react';\nimport UserContext from '../context/UserContext'; //services\n\nimport { login, loginTwoFactor, requestNewCode, generateAccount, activateAccount } from '../services/auth'; //config\n\nimport { setAuthorizationHeader } from '../config/axios'; //utils\n\nimport Utils from '../lib/utils';\nexport default function useUser() {\n  _s();\n\n  var _useContext = useContext(UserContext),\n      jwt = _useContext.jwt,\n      setJWT = _useContext.setJWT,\n      twoFactorAuth = _useContext.twoFactorAuth,\n      setTwoFactorAuth = _useContext.setTwoFactorAuth;\n\n  var signIn = useCallback(function (payload) {\n    return login(payload).then(function (response) {\n      var token = response.token,\n          twoFactorAuth = response.twoFactorAuth;\n      setAuthorizationHeader(token);\n      setTwoFactorAuth(twoFactorAuth);\n    })[\"catch\"](function (error) {\n      throw new Error(Utils.parseApiError(error));\n    });\n  }, [setTwoFactorAuth]);\n  var signUp = useCallback(function (payload) {\n    return generateAccount(payload).then(function (response) {\n      var token = response.token,\n          account = response.account;\n      setAuthorizationHeader(token);\n      return account;\n    })[\"catch\"](function (error) {\n      throw new Error(Utils.parseApiError(error));\n    });\n  }, []);\n  var activate = useCallback(function (payload) {\n    return activateAccount(payload).then(function () {\n      return setAuthorizationHeader(null);\n    })[\"catch\"](function (error) {\n      throw new Error(Utils.parseApiError(error));\n    });\n  }, []);\n  var singOut = useCallback(function () {\n    sessionStorage.removeItem('auth-token');\n    setJWT(null);\n  }, [setJWT]);\n  var twoFactorSignIn = useCallback(function (payload) {\n    return loginTwoFactor(payload).then(function (response) {\n      setJWT(response);\n      setAuthorizationHeader(response);\n      sessionStorage.setItem('auth-token', response);\n    })[\"catch\"](function (error) {\n      throw new Error(Utils.parseApiError(error));\n    });\n  }, [setJWT]);\n  var twoFactorSignUp = useCallback(function (payload) {\n    return loginTwoFactor(payload).then(function (response) {\n      setAuthorizationHeader(response);\n    })[\"catch\"](function (error) {\n      throw new Error(Utils.parseApiError(error));\n    });\n  }, []);\n  var requestNewSecurityCode = useCallback(function () {\n    return requestNewCode()[\"catch\"](function (error) {\n      throw new Error(Utils.parseApiError(error));\n    });\n  }, []);\n\n  var clearToken = function clearToken() {\n    setJWT(null);\n    sessionStorage.removeItem('auth-token');\n  };\n\n  return {\n    jwt: jwt,\n    twoFactorAuth: twoFactorAuth,\n    isLoggedIn: Boolean(jwt),\n    signIn: signIn,\n    signUp: signUp,\n    activate: activate,\n    singOut: singOut,\n    twoFactorSignIn: twoFactorSignIn,\n    twoFactorSignUp: twoFactorSignUp,\n    requestNewSecurityCode: requestNewSecurityCode,\n    clearToken: clearToken\n  };\n}\n\n_s(useUser, \"Ky4E1PfNl0L5SAvHbT8QOdM6ZwE=\");","map":{"version":3,"sources":["/home/juanma/projects/membrane-front/src/legacy/hooks/useUser.js"],"names":["useCallback","useContext","UserContext","login","loginTwoFactor","requestNewCode","generateAccount","activateAccount","setAuthorizationHeader","Utils","useUser","jwt","setJWT","twoFactorAuth","setTwoFactorAuth","signIn","payload","then","response","token","error","Error","parseApiError","signUp","account","activate","singOut","sessionStorage","removeItem","twoFactorSignIn","setItem","twoFactorSignUp","requestNewSecurityCode","clearToken","isLoggedIn","Boolean"],"mappings":"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","sourcesContent":["import { useCallback, useContext } from 'react';\nimport UserContext from '../context/UserContext';\n\n//services\nimport {\n  login,\n  loginTwoFactor,\n  requestNewCode,\n  generateAccount,\n  activateAccount\n} from '../services/auth';\n\n//config\nimport { setAuthorizationHeader } from '../config/axios';\n\n//utils\nimport Utils from '../lib/utils';\n\nexport default function useUser() {\n  const { jwt, setJWT, twoFactorAuth, setTwoFactorAuth } =\n    useContext(UserContext);\n\n  const signIn = useCallback(\n    payload => {\n      return login(payload)\n        .then(response => {\n          const { token, twoFactorAuth } = response;\n\n          setAuthorizationHeader(token);\n          setTwoFactorAuth(twoFactorAuth);\n        })\n        .catch(error => {\n          throw new Error(Utils.parseApiError(error));\n        });\n    },\n    [setTwoFactorAuth]\n  );\n\n  const signUp = useCallback(payload => {\n    return generateAccount(payload)\n      .then(response => {\n        const { token, account } = response;\n        setAuthorizationHeader(token);\n        return account;\n      })\n      .catch(error => {\n        throw new Error(Utils.parseApiError(error));\n      });\n  }, []);\n\n  const activate = useCallback(payload => {\n    return activateAccount(payload)\n      .then(() => setAuthorizationHeader(null))\n      .catch(error => {\n        throw new Error(Utils.parseApiError(error));\n      });\n  }, []);\n\n  const singOut = useCallback(() => {\n    sessionStorage.removeItem('auth-token');\n    setJWT(null);\n  }, [setJWT]);\n\n  const twoFactorSignIn = useCallback(\n    payload => {\n      return loginTwoFactor(payload)\n        .then(response => {\n          setJWT(response);\n          setAuthorizationHeader(response);\n          sessionStorage.setItem('auth-token', response);\n        })\n        .catch(error => {\n          throw new Error(Utils.parseApiError(error));\n        });\n    },\n    [setJWT]\n  );\n\n  const twoFactorSignUp = useCallback(payload => {\n    return loginTwoFactor(payload)\n      .then(response => {\n        setAuthorizationHeader(response);\n      })\n      .catch(error => {\n        throw new Error(Utils.parseApiError(error));\n      });\n  }, []);\n\n  const requestNewSecurityCode = useCallback(() => {\n    return requestNewCode().catch(error => {\n      throw new Error(Utils.parseApiError(error));\n    });\n  }, []);\n\n  const clearToken = () => {\n    setJWT(null);\n    sessionStorage.removeItem('auth-token');\n  };\n\n  return {\n    jwt,\n    twoFactorAuth,\n    isLoggedIn: Boolean(jwt),\n    signIn,\n    signUp,\n    activate,\n    singOut,\n    twoFactorSignIn,\n    twoFactorSignUp,\n    requestNewSecurityCode,\n    clearToken\n  };\n}\n"]},"metadata":{},"sourceType":"module"}